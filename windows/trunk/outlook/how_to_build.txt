How to build the Funambol Outlook Sync Client
---------------------------------------------

1. Overview

    The Outlook Sync Client consists of 4 projects: 
    - OutlookPlugin: the GUI interface of the Plug-in, written in C++ with MFC support (Microsoft Foundation Classes) 
    - winmainclientdll: the Client DLL, used by OutlookPlugin, written in C++ with STL support (Standard Library) 
    - FunambolAddin: the COM Addin for Microsoft Outlook 
    - win32: the Funambol native API C++ for Windows32; winmainclientdll and FunambolAddin are based on this project 

    All projects are developed in C++. 


2. Requirements

    To compile the source files, you need to install the following: 
    - Microsoft Visual Studio 2005. All projects have been developed with Microsoft Visual Studio 2005, the installation process has been automated using Microsoft Visual Studio 2005 C++ compiler. 
    - Microsoft Outlook 2003 or later. winmainclientdll and FunambolAddin projects import some Microsoft Outlook libraries, so you need to install Microsoft Outlook to register these libraries into the System. 

    To build the installer, you need to download and install the following: 
    - Apache Ant (http://ant.apache.org/) 
    - NSIS (http://nsis.sourceforge.net) 
    - NSIS processwork plugin (http://www.esanu.name/software/wp-content/uploads/2008/06/processwork.rar). Extract 'processwork.dll' inside the 'Plugins' folder under the NSIS installation directory (this library will be used building the installer). 
    - Doxygen (http://www.stack.nl/~dimitri/doxygen/download.html) 
    - [optional] Graphviz (to generate graphs in doxygen doc, http://www.graphviz.org/Download..php)


3. Building the installer

    The installer is a NSIS Windows installer, launched by the Apache 'ant' build tool.
    During the building process, all projects are compiled using the Visual Studio compiler.
    
    1) Checkout the Outlook Sync Client project from SVN.
       The project repository is: https://core.forge.funambol.org/svn/core/
       HEAD revision can be found under 'trunk/outlook' path, tags are located under 'tags' (use "guest" username with an empty password).
       Note: external projects (like Funambol C++ APIs) will be checkout automatically.
    2) Open file 'install\build\funambol-outlook-client-forge.properties'
       - redefine the path of Visual Studio 2005 (devenv.exe) (if different)
       - redefine the path of the directory 'redist\x86' of Visual Studio 2005 if necessary 
       - redefine the path of NSIS (makensis.exe) if necessary 
    3) Open file 'install\build\release.properties' and set the release version number desired.
    4) From directory 'install\build', type 'ant work-all'. 
       This procedure will build the installer, doing the following: 
       - register Redemption library
       - create the doxygen documentation 
       - create a zip file containing the source files 
       - build the Outlook Sync Client installer
       
    Output files will be placed in 'install\output'.
    Doxygen documentation is generated in 'docs\html'; the start page is 'index.html'.
    
    Note: with "ant release" you can build the Outlook Sync Client installer as well, but all source files will be downloaded from SVN by the script.
